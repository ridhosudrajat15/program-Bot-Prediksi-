<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bot Prediksi Sepakbola</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    #chatArea {
      scroll-behavior: smooth;

    .history-item.active {
  background-color: #4a5568; /* bg-gray-700 */
}  
    }
  </style>
</head>
<body class="bg-gray-900 text-white">


  <div id="sidebar" class="fixed top-0 left-0 h-full w-64 bg-gray-800 text-white p-4 transform -translate-x-full transition-transform duration-300 z-50 overflow-y-auto">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-xl font-bold">Menu</h2>
    <button onclick="toggleSidebar()">‚úñ</button>
  </div>
  <button onclick="startNewChat()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg mb-4">
    ‚ûï Obrolan Baru
  </button>
  
  <h3 class="text-lg font-semibold mb-2 mt-4 border-t border-gray-700 pt-4">Riwayat Obrolan</h3>
  <ul id="history-list" class="space-y-2">
    </ul>
  
  <h3 class="text-lg font-semibold mb-2 mt-4 border-t border-gray-700 pt-4">Lainnya</h3>
  <ul id="menu-static" class="space-y-4">
    <li><a href="tentangkami.html" class="block hover:text-green-400">‚ÑπÔ∏è Tentang Kami</a></li>
    <li><a href="panduanbot.html" class="block hover:text-green-400">üìñ Panduan Bot</a></li>
  </ul>
</div>

  <!-- ‚úÖ OVERLAY -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden" onclick="toggleSidebar()"></div>

  <!-- ‚úÖ HEADER -->
  <header class="bg-gray-800 fixed top-0 left-0 w-full z-30 flex justify-between items-center px-4 py-3">
    <button class="text-white text-2xl" onclick="toggleSidebar()">‚ò∞</button>
    <h1 class="text-lg font-bold">Bot Prediksi Sepakbola</h1>
    <button class="text-white text-2xl">üáÆüá©</button>
  </header>

 <!-- ‚úÖ MAIN -->
<main id="chatArea" class="relative pt-20 pb-24 px-4 space-y-4 overflow-y-auto max-w-4xl mx-auto h-[calc(100vh-8rem)]">
  <!-- Welcome Message -->
  <div id="welcomeMessage" class="absolute inset-0 flex flex-col justify-center items-center text-center text-gray-400 px-4">
    <h2 class="text-2xl font-bold mb-2">Selamat datang di Bot Prediksi Sepakbola ‚öΩ</h2>
    <p class="text-base">Tanyakan apa saja seputar pertandingan bola atau unggah foto tim favoritmu!</p>
  </div>
  <!-- chat muncul di sini -->
</main>


  <!-- ‚úÖ FOOTER -->
 <footer class="bg-gray-800 fixed bottom-0 left-0 w-full z-50 p-3 flex items-center space-x-2  px-4 py-3">

    <!-- Tombol ‚ûï dengan menu -->
    <div class="relative">
      <button onclick="toggleUploadMenu()" class="text-white text-xl">‚ûï</button>
      <div id="uploadMenu" class="absolute bottom-12 left-0 bg-gray-700 text-sm rounded-lg hidden shadow-md z-50 w-40">
        <label class="flex items-center px-4 py-2 hover:bg-gray-600 cursor-pointer gap-2">
          üì∑ Ambil Foto
          <input type="file" accept="image/*" capture="environment" onchange="handleImage(this.files[0])" class="hidden">
        </label>
        <label class="flex items-center px-4 py-2 hover:bg-gray-600 cursor-pointer gap-2">
          üñºÔ∏è Tambah Foto
          <input type="file" accept="image/*" onchange="handleImage(this.files[0])" class="hidden">
        </label>
        <label class="flex items-center px-4 py-2 hover:bg-gray-600 cursor-pointer gap-2">
          üìÅ Tambah File
          <input type="file" onchange="handleImage(this.files[0])" class="hidden">
        </label>
      </div>
    </div>

    <!-- Input teks -->
    <input id="userInput" type="text" placeholder="Tulis pertanyaan di sini..."
      class="flex-1 bg-gray-700 text-white px-4 py-2 rounded-full outline-none"
      onkeydown="if(event.key==='Enter') kirimPesan()" />

    <!-- Tombol kirim -->
    <button class="text-white text-xl" onclick="kirimPesan()">‚úîÔ∏è</button>
  </footer>

  <script>
    let currentChatId = null;

// Fungsi ini akan berjalan saat halaman selesai dimuat
document.addEventListener('DOMContentLoaded', () => {
  const lastActiveId = localStorage.getItem('football_last_active_chat');
  if (lastActiveId) {
    loadChat(lastActiveId);
  } else {
    startNewChat(false);
  }
  renderHistorySidebar();
});

// Mengambil semua data riwayat dari localStorage
function getChatHistory() {
  return JSON.parse(localStorage.getItem('football_chat_history')) || {};
}

// Menyimpan object riwayat ke localStorage
function saveChatHistory(history) {
  localStorage.setItem('football_chat_history', JSON.stringify(history));
}

// Menampilkan daftar riwayat di sidebar
function renderHistorySidebar() {
  const historyList = document.getElementById('history-list');
  historyList.innerHTML = '';
  const history = getChatHistory();
  const sortedKeys = Object.keys(history).sort((a, b) => b.replace('chat_', '') - a.replace('chat_', ''));

  for (const chatId of sortedKeys) {
    const item = history[chatId];
    const li = document.createElement('li');
    li.className = `history-item p-2 rounded-md cursor-pointer hover:bg-gray-700 flex justify-between items-center text-sm`;
    if (chatId === currentChatId) {
      li.classList.add('active');
    }
    
    const titleSpan = document.createElement('span');
    titleSpan.textContent = item.title.length > 20 ? item.title.substring(0, 20) + '...' : item.title;
    titleSpan.className = 'flex-grow';
    titleSpan.onclick = () => loadChat(chatId);

    const deleteBtn = document.createElement('button');
    deleteBtn.textContent = 'üóëÔ∏è';
    deleteBtn.className = 'ml-2 hover:text-red-400';
    deleteBtn.onclick = (e) => {
      e.stopPropagation();
      deleteChat(chatId);
    };

    li.appendChild(titleSpan);
    li.appendChild(deleteBtn);
    historyList.appendChild(li);
  }
}

// Menyimpan percakapan saat ini
function saveCurrentChat() {
  if (!currentChatId) return;
  const chatArea = document.getElementById('chatArea');
  const firstUserBubble = chatArea.querySelector('.bg-green-200');
  const history = getChatHistory();
  let title = firstUserBubble ? firstUserBubble.textContent.trim() : "Obrolan baru";

  history[currentChatId] = {
    title: title,
    html: chatArea.innerHTML,
    namaUser: namaUser
  };
  saveChatHistory(history);
  renderHistorySidebar();
}

// Memuat percakapan lama dari riwayat
function loadChat(chatId) {
  const history = getChatHistory();
  if (!history[chatId]) {
    startNewChat();
    return;
  }
  const chatData = history[chatId];
  document.getElementById('chatArea').innerHTML = chatData.html;
  currentChatId = chatId;
  namaUser = chatData.namaUser || "";
  localStorage.setItem('football_last_active_chat', chatId);
  document.getElementById('welcomeMessage')?.remove();
  toggleSidebar(true);
  renderHistorySidebar();
  scrollToBottom();
}

// Menghapus satu item riwayat
function deleteChat(chatId) {
  if (!confirm("Anda yakin ingin menghapus obrolan ini?")) return;
  const history = getChatHistory();
  delete history[chatId];
  saveChatHistory(history);
  if (currentChatId === chatId) {
    localStorage.removeItem('football_last_active_chat');
    startNewChat(false);
  }
  renderHistorySidebar();
}

// Memulai sesi obrolan baru
function startNewChat(closeSidebar = true) {
  currentChatId = null;
  namaUser = "";
  document.getElementById('chatArea').innerHTML = `
    <div id="welcomeMessage" class="absolute inset-0 flex flex-col justify-center items-center text-center text-gray-400 px-4">
      <h2 class="text-2xl font-bold mb-2">Selamat datang di Bot Prediksi Sepakbola ‚öΩ</h2>
      <p class="text-base">Tanyakan apa saja seputar pertandingan bola atau unggah foto tim favoritmu!</p>
    </div>
  `;
  localStorage.removeItem('football_last_active_chat');
  if (closeSidebar) {
    toggleSidebar(true);
  }
  renderHistorySidebar();
}
    let namaUser = "";

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('-translate-x-full');
      document.getElementById('overlay').classList.toggle('hidden');
    }

  function toggleUploadMenu() {
  const menu = document.getElementById("uploadMenu");
  menu.classList.toggle("hidden");

  // Tunggu sebentar sebelum menambahkan listener luar
  setTimeout(() => {
    document.addEventListener("click", closeMenuOutside, { once: true });
  }, 100);
}


  function closeMenuOutside(e) {
  const menu = document.getElementById("uploadMenu");
  const button = document.querySelector("button[onclick='toggleUploadMenu()']");
  if (!menu.contains(e.target) && !button.contains(e.target)) {
    menu.classList.add("hidden");
  }
}

    function handleImage(file) {
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const imgDiv = document.createElement("div");
          imgDiv.className = "w-fit max-w-[80%]";
          imgDiv.innerHTML = `<img src="${e.target.result}" class="rounded-xl max-w-xs mb-2" alt="gambar kiriman">`;
          document.getElementById('chatArea').appendChild(imgDiv);

          setTimeout(() => {
            tampilkanBalasan("Gambar diterima! Akan saya analisis dalam konteks sepak bola ‚öΩüì∑");
          }, 700);

          scrollToBottom();
        };
        reader.readAsDataURL(file);
      }
    }

    function scrollToBottom() {
      const chatArea = document.getElementById('chatArea');
      chatArea.scrollTop = chatArea.scrollHeight;
    }

   function tampilkanBalasan(teks) {
  const botBubble = document.createElement('div');
  botBubble.className = 'bg-white text-black p-3 rounded-lg w-fit max-w-[80%] mb-2';
  botBubble.innerHTML = teks.replace(/\n/g, '<br>'); // Agar format baris baru terbaca
  document.getElementById('chatArea').appendChild(botBubble);
  scrollToBottom();
  saveCurrentChat(); // Simpan chat setelah bot membalas
}

   async function kirimPesan() {
  const input = document.getElementById('userInput');
  const pesan = input.value.trim();
  if (pesan === '') return;

  if (!currentChatId) {
    currentChatId = 'chat_' + Date.now();
    localStorage.setItem('football_last_active_chat', currentChatId);
    renderHistorySidebar();
  }

  document.getElementById('welcomeMessage')?.remove();

  const userBubble = document.createElement('div');
  userBubble.className = 'bg-green-200 text-black p-3 rounded-lg w-fit max-w-[80%] ml-auto';
  userBubble.textContent = pesan;
  document.getElementById('chatArea').appendChild(userBubble);

  const teks = pesan.toLowerCase();
  input.value = '';
  input.focus();
  scrollToBottom();
  saveCurrentChat();
      if (teks.includes("prediksi") && teks.includes("vs")) {
  getPrediksiScoreDanOverUnder(teks).then(res => tampilkanBalasan(res));
  input.value = '';
  return;
}

// ‚úÖ 2. Pertandingan semua liga hari ini
if (["pertandingan bola malam ini", "pertandingan bola hari ini", "bola malam ini", "pertandingan hari ini"].some(k => teks.includes(k))) {
  getJadwalSemuaLigaHariIni().then(res => tampilkanBalasan(res));
  input.value = '';
  return;
}

// ‚úÖ 3. Jadwal liga tertentu (liga inggris, la liga, dll)
if (teks.includes("liga")) {
  getJadwalLigaHariIni(teks).then(res => tampilkanBalasan(res));
  input.value = '';
  return;
}

else if (teks.includes("peluang menang") && teks.includes("vs")) {
  getPeluangMenang(teks).then(res => tampilkanBalasan(res));
  input.value = '';
  return;
}


const sapaanKeywords = [
  "halo", "hai", "hi", "hay", "hy", "hallo", "p",
  "bro", "gan", "bos",
  "assalamualaikum",
  "selamat pagi", "selamat siang", "selamat sore", "selamat malam",
  "misi", "permisi", "punten"
];

if (teks.includes("nama saya") || teks.includes("saya") || teks.includes("aku")) {
        const namaMatch = teks.match(/(nama saya|saya|aku)\s+([a-zA-Z]+)/);
        if (namaMatch && namaMatch[2]) {
          namaUser = namaMatch[2].charAt(0).toUpperCase() + namaMatch[2].slice(1);
          balasan = `Hai ${namaUser}! Nama kamu keren ‚öΩ. Silakan tanya tentang sepak bola!`;
        } else {
          balasan = "Boleh tahu siapa nama kamu, bro?";
        }

 } else if ([
  "apa kabar", "gimana kabar", "gmn kabar", "kabar kamu", "kabar lu", "kabarnya",
  "lagi apa", "lagi ngapain", "sedang apa", "ngapain bro", "ngapain kamu",
  "gimana", "gmn", "sehat", "sehat gak", "sehat ga", "sehat kah", "baik kah",
  "baik nggak", "baik ga", "baik gak", "kabar lo", "kbr lu", "kbr kamu",
  "kabarmu", "keadaan kamu", "kondisi kamu", "keadaan bot", "bot sehat?",
  "lagi sibuk ya", "sibuk ya", "capek gak", "bot cape?", "cape ya", "cape bro", 
  "lagi santai?", "santai aja", "santai bro?", "santai dong", "kamu sibuk?", 
  "kamu lagi apa", "kamu sibuk ga", "bot lagi ngapain"
].some(k => teks.includes(k))) {

  if (
    teks.includes("lagi apa") || teks.includes("lagi ngapain") || 
    teks.includes("sedang apa") || teks.includes("ngapain bro") || 
    teks.includes("ngapain kamu") || teks.includes("bot lagi ngapain")
  ) {
    balasan = namaUser
      ? `Lagi nunggu kamu nih ${namaUser}, biar kita bahas bola bareng ‚öΩ`
      : "Lagi nunggu pertanyaan bola dari kamu bro! Yuk tanya aja ‚öΩ";
  } else if (
    teks.includes("sehat") || teks.includes("sehat gak") || teks.includes("sehat ga") ||
    teks.includes("sehat kah") || teks.includes("bot sehat") || teks.includes("baik kah")
  ) {
    balasan = namaUser
      ? `Alhamdulillah sehat ${namaUser}, semoga kamu juga selalu sehat dan semangat ‚öΩ`
      : "Saya sehat bro, semoga kamu juga sehat selalu ya ‚öΩ";
  } else if (
    teks.includes("sibuk") || teks.includes("lagi sibuk") || teks.includes("kamu sibuk")
  ) {
    balasan = namaUser
      ? `Lagi gak sibuk kok ${namaUser}, aku selalu standby buat bantu kamu soal bola ‚öΩ`
      : "Gak sibuk bro, kapan pun kamu butuh info bola, aku siap ‚öΩ";
  } else if (
    teks.includes("cape") || teks.includes("capek")
  ) {
    balasan = namaUser
      ? `Kalau capek, rehat sebentar ya ${namaUser}. Nonton bola bisa bantu refreshing ‚öΩ`
      : "Kalau capek, jangan lupa istirahat ya bro! Yuk bahas bola biar semangat ‚öΩ";
  } else if (
    teks.includes("santai")
  ) {
    balasan = namaUser
      ? `Santai aja ${namaUser}, ngobrolin bola emang paling asik ‚öΩ`
      : "Santai bro! Mau bahas bola apa hari ini? ‚öΩ";
  } else if (
    teks.includes("kabar") || teks.includes("gimana") || teks.includes("gmn") || teks.includes("keadaan") || teks.includes("kondisi")
  ) {
    balasan = namaUser
      ? `Saya baik ${namaUser}, kamu gimana? Siap bahas liga favorit? ‚öΩ`
      : "Saya baik kok bro! Yuk mulai bahas bola ‚öΩ";
  } else {
    balasan = namaUser
      ? `Saya oke ${namaUser}, siap bantu kamu soal bola kapan aja ‚öΩ`
      : "Saya oke bro! Silakan tanya jadwal, prediksi, atau data bola ‚öΩ";
  }
} else if ([
  "siapa kamu", "nama kamu", "kamu siapa", "lu siapa", "siapa ini", "kamu robot ya",
  "kamu manusia", "kamu manusia?", "lu manusia?", "apakah kamu manusia",
  "buat apa kamu", "fungsi kamu apa", "kenapa kamu dibuat", "tujuan kamu apa",
  "siapa yg bikin kamu", "siapa yang bikin kamu", "siapa yang buat kamu", "sejak kapan kamu dibuat", "umur kamu", "berapa umur kamu",
  "dari mana", "asal kamu", "lokasi kamu"
].some(k => teks.includes(k))) {

  if (["siapa kamu", "nama kamu", "kamu siapa", "lu siapa", "siapa ini"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Saya BotPrediksi ‚öΩ, asisten bola kamu, ${namaUser}! Siap bantu kapan pun.`
      : "Saya BotPrediksi ‚öΩ, asisten bola kamu! Siap bantu 24 jam!";
  } else if (["kamu robot", "robot ya"].some(k => teks.includes(k))) {
    balasan = "Yap, saya bot pintar ü§ñ khusus untuk bantu soal bola ‚öΩ";
  } else if (["kamu manusia", "apakah kamu manusia", "lu manusia"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Saya bukan manusia, ${namaUser}, saya bot ‚öôÔ∏è yang dibuat untuk bantu kamu soal bola ‚öΩ`
      : "Saya bukan manusia, saya bot ‚öôÔ∏è yang dibuat khusus untuk bantu kamu soal bola ‚öΩ";
  } else if (["kenapa kamu dibuat", "tujuan kamu apa", "buat apa kamu", "fungsi kamu apa"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Saya dibuat untuk bantu para penggemar bola seperti kamu, ${namaUser}, dalam hal prediksi, jadwal, dan data pertandingan ‚öΩ`
      : "Saya dibuat untuk bantu para penggemar bola dalam hal prediksi, jadwal, dan data pertandingan ‚öΩ";
  } else if (["umur kamu", "berapa umur kamu", "sejak kapan kamu dibuat"].some(k => teks.includes(k))) {
    balasan = "Saya masih muda banget! Bot ini mulai aktif sejak tahun 2025 ‚öΩüë∂";
  } else if (["siapa yg bikin kamu","siapa yang bikin kamu", "siapa yang buat kamu"].some(k => teks.includes(k))) {
    balasan = "Saya dibuat oleh Marcel ‚Äî penggemar bola & teknologi dari Indonesia üáÆüá©";
  } else if (["dari mana", "asal kamu", "lokasi kamu"].some(k => teks.includes(k))) {
    balasan = "Saya bot virtual buatan lokal, Indonesia punya! üáÆüá©";
  } else {
    balasan = namaUser
      ? `Saya BotPrediksi, ${namaUser}, dibuat untuk bantu kamu soal bola kapan saja ‚öΩ`
      : "Saya BotPrediksi, dibuat untuk bantu kamu soal bola kapan saja ‚öΩ";
  }
} else if (sapaanKeywords.some(k => teks.includes(k))) {
  if (/\bp\b/.test(teks)) {
    balasan = namaUser ? `P juga, ${namaUser}! Siap bahas bola? ‚öΩ` : "P juga! Yuk bahas bola ‚öΩ";
  } else if (teks.includes("assalamualaikum")) {
    balasan = namaUser
      ? `Waalaikumsalam ${namaUser}, semoga sehat selalu! Siap bahas bola? ‚öΩ`
      : "Waalaikumsalam! Siap bantu soal bola bro ‚öΩ";
  } else if (teks.includes("selamat pagi")) {
    balasan = namaUser
      ? `Selamat pagi ${namaUser}! Semoga harimu penuh gol ‚öΩ`
      : "Pagi! Yuk bahas jadwal bola hari ini ‚öΩ";
  } else if (teks.includes("selamat siang")) {
    balasan = namaUser
      ? `Siang ${namaUser}, istirahat sambil lihat prediksi bola yuk ‚öΩ`
      : "Selamat siang! Ada jadwal seru hari ini ‚öΩ";
  } else if (teks.includes("selamat sore")) {
    balasan = namaUser
      ? `Sore ${namaUser}, siap nonton bola nanti malam? ‚öΩ`
      : "Selamat sore bro! Ada match menarik malam ini ‚öΩ";
  } else if (teks.includes("selamat malam")) {
    balasan = namaUser
      ? `Malam ${namaUser}, prediksi bola udah siap ‚öΩ`
      : "Selamat malam! Yuk bahas skor pertandingan ‚öΩ";
  } else if (["bro", "gan", "bos"].some(k => teks.includes(k))) {
    if (teks.includes("bro")) {
      balasan = namaUser
        ? `Broo ${namaUser}, siap prediksi bola hari ini? ‚öΩ`
        : "Broo! Mau bahas bola tim mana nih? ‚öΩ";
    } else if (teks.includes("gan")) {
      balasan = namaUser
        ? `Halo gan ${namaUser}! Lagi cari prediksi tim favorit? ‚öΩ`
        : "Halo gan! Yuk tanya seputar bola ‚öΩ";
    } else if (teks.includes("bos")) {
      balasan = namaUser
        ? `Halo bos ${namaUser}! Siap bantu prediksi ‚öΩ`
        : "Halo bos! Mau bahas siapa nih, MU atau Madrid? ‚öΩ";
    }
  } else if (teks.includes("misi")) {
    balasan = namaUser
      ? `Iya ${namaUser}, apakah ada yang ingin ditanyakan? ‚öΩ`
      : "Iya, apakah ada yang ingin ditanyakan? ‚öΩ";
  } else if (teks.includes("permisi")) {
    balasan = namaUser
      ? `Iya ${namaUser}, apakah bisa saya bantu? ‚öΩ`
      : "Iya, apakah bisa saya bantu? ‚öΩ";
  } else if (teks.includes("punten")) {
    balasan = namaUser
      ? `Iya ${namaUser}, silakan bertanya ‚öΩ`
      : "Iya, silakan bertanya ‚öΩ";
  } else {
    balasan = namaUser
      ? `Halo ${namaUser}! Siap bahas bola? ‚öΩ`
      : "Halo! Selamat datang di BotPrediksi ‚öΩ. Silakan tanya tentang bola ya!";
  }
  
} else if (["terima kasih", "makasih", "thanks", "makasih banyak", "trimakasih", "trims"].some(k => teks.includes(k))) {
  if (teks.includes("makasih banyak") || teks.includes("terima kasih banyak")) {
    balasan = namaUser
      ? `Sama-sama ${namaUser}! Senang bisa bantu kamu soal bola ‚öΩ`
      : "Sama-sama! Senang bisa bantu kamu soal bola ‚öΩ";
  } else if (teks.includes("thanks")) {
    balasan = namaUser
      ? `You're welcome ${namaUser}! Tetap semangat dukung tim favorit kamu ‚öΩ`
      : "You're welcome! Semangat terus dukung tim kamu ‚öΩ";
  } else {
    balasan = namaUser
      ? `Sama-sama ${namaUser}! Jangan lupa tanya prediksi lagi ya ‚öΩ`
      : "Sama-sama bro! Kapan pun mau tanya bola, saya siap ‚öΩ";
  }

  } else if ([
  "keren", "hebat", "pintar", "pinter", "botnya keren", "lu pintar", "kamu pintar", 
  "bot canggih", "lu keren", "kamu keren", "keren juga", "mantap bot", "gg bot", "bagus bot",
  "mantul", "gokil", "top banget", "oke banget", "botnya mantap", "lu mantap", "the best",
  "kerennn", "kerenn banget", "lu top", "botnya top", "lu jago", "kamu jago", "jago juga",
  "kamu bagus", "lu bagus", "keren bot", "canggih juga", "botnya bagus", "bot jago", 
  "lu smart", "kamu smart", "cerdas juga", "bagus banget"
].some(k => teks.includes(k))) {
  if (teks.includes("keren")) {
    balasan = namaUser ? `Makasih ${namaUser}, kamu juga keren banget! ‚öΩüî•` : "Makasih! Kamu juga keren bro! ‚öΩ";
  } else if (teks.includes("hebat")) {
    balasan = namaUser ? `Wah terima kasih ${namaUser}, semoga kamu juga makin hebat! ‚öΩüí™` : "Makasih! Kamu juga hebat bro! ‚öΩ";
  }
} else if (teks.includes("hebat")) {
  balasan = namaUser ? `Wah terima kasih ${namaUser}, semoga kamu juga makin hebat! ‚öΩüí™` : "Makasih! Kamu juga hebat bro! ‚öΩ";

} else if (teks.includes("pintar") || teks.includes("pinter")) {
  balasan = namaUser ? `Haha makasih ${namaUser}, saya belajar dari kamu juga nih ‚öΩüß†` : "Makasih bro! Pintarnya bareng-bareng dong ‚öΩ";

} else if (teks.includes("botnya keren")) {
  balasan = namaUser ? `Wah makasih banyak ${namaUser}, saya jadi semangat bantu kamu soal bola ‚öΩ` : "Bot senang dengar itu! ‚öΩ";

} else if (teks.includes("lu pintar") || teks.includes("kamu pintar")) {
  balasan = namaUser ? `Makasih ${namaUser}, kamu juga paham bola banget ‚öΩüß†` : "Thanks bro! Yuk ngobrolin bola terus ‚öΩ";

} else if (teks.includes("bot canggih") || teks.includes("canggih juga")) {
  balasan = namaUser ? `Teknologi sekarang emang keren ya ${namaUser} üòé‚öΩ` : "Bot makin canggih demi bantu kamu bro ‚öôÔ∏è‚öΩ";

} else if (teks.includes("lu keren") || teks.includes("kamu keren")) {
  balasan = namaUser ? `Kamu juga keren ${namaUser}, kita tim hebat! ‚öΩüî•` : "Sama-sama keren bro! üî•";

} else if (teks.includes("keren juga")) {
  balasan = namaUser ? `Haha makasih ${namaUser}, kita saling keren ya ‚öΩüôå` : "Makasih bro! Sama-sama keren dong ‚öΩ";

} else if (teks.includes("mantap bot") || teks.includes("mantap")) {
  balasan = namaUser ? `Makasih ${namaUser}! Kamu juga mantap jiwa ‚öΩüí™` : "Mantap! Yuk lanjut bahas bola bro ‚öΩ";

} else if (teks.includes("gg bot") || teks.includes("gg")) {
  balasan = namaUser ? `GG juga kamu ${namaUser}! ‚öΩüî•` : "GG bro! Kita kompak soal bola ‚öΩ";

} else if (teks.includes("bagus bot") || teks.includes("bagus banget") || teks.includes("botnya bagus")) {
  balasan = namaUser ? `Terima kasih ${namaUser}, saya berusaha bantu sebaik mungkin ‚öΩ` : "Makasih! Senang bisa bantu ‚öΩ";

} else if (teks.includes("mantul")) {
  balasan = namaUser ? `Mantul banget ${namaUser}! Yuk bahas tim kesayangan ‚öΩüî•` : "Mantul bro! Yuk lanjut ‚öΩ";

} else if (teks.includes("gokil")) {
  balasan = namaUser ? `Haha gokil juga kamu ${namaUser}! ‚öΩü§£` : "Gokil bro! Prediksi bola hari ini siap ‚öΩ";

} else if (teks.includes("top banget") || teks.includes("top")) {
  balasan = namaUser ? `Top juga kamu ${namaUser}! Ayo bahas match favorit ‚öΩ` : "Top markotop bro! ‚öΩ";

} else if (teks.includes("oke banget")) {
  balasan = namaUser ? `Thanks ${namaUser}, kamu juga oke banget! ‚öΩ‚ú®` : "Oke banget bro! Yuk lanjut ‚öΩ";

} else if (teks.includes("botnya mantap")) {
  balasan = namaUser ? `Bot makin semangat dibilang gitu, makasih ${namaUser}! ‚öΩüî•` : "Terima kasih! Bot makin semangat ‚öΩ";

} else if (teks.includes("lu mantap")) {
  balasan = namaUser ? `Kamu juga mantap ${namaUser}! ‚öΩüî•` : "Sama-sama mantap bro! ‚öΩ";

} else if (teks.includes("the best")) {
  balasan = namaUser ? `Kamu juga the best ${namaUser}! ‚öΩüíØ` : "Makasih bro! Kamu juga the best! ‚öΩ";

} else if (teks.includes("kerennn") || teks.includes("kerenn banget")) {
  balasan = namaUser ? `Kerennya sampe triple N nih, makasih ${namaUser}! ‚öΩüî•` : "Wuihh makasih! ‚öΩüî•";

} else if (teks.includes("lu top") || teks.includes("botnya top")) {
  balasan = namaUser ? `Top juga kamu ${namaUser}! ‚öΩüôå` : "Sama-sama top bro! ‚öΩ";

} else if (teks.includes("lu jago") || teks.includes("kamu jago") || teks.includes("jago juga") || teks.includes("bot jago")) {
  balasan = namaUser ? `Jago bareng kamu nih ${namaUser}! ‚öΩüî•` : "Jago berdua lebih asik! ‚öΩüî•";

} else if (teks.includes("kamu bagus") || teks.includes("lu bagus")) {
  balasan = namaUser ? `Thanks ${namaUser}, kamu juga hebat dalam ngobrolin bola! ‚öΩ` : "Makasih bro! Yuk terus seru-seruan ‚öΩ";

} else if (teks.includes("keren bot")) {
  balasan = namaUser ? `Makasih ${namaUser}, senang bisa bantu kamu ‚öΩüî•` : "Wah makasih! Yuk terus tanya bola ‚öΩ";

} else if (teks.includes("lu smart"
) || teks.includes("kamu smart")) {
  balasan = namaUser ? `Hehe, kamu juga smart ${namaUser}! Kita cocok jadi tim ‚öΩüß†` : "Thanks! Kamu juga jenius bola bro! ‚öΩ";

} else if ([
  "bot error", "ngaco", "bohong kamu", "bohong lu", "bohong", 
  "salah lu", "lu salah", "bot goblok", "goblok kamu", "bot bodoh", 
  "bot bego", "bot jelek", "kamu aneh", "bot aneh", "gak jelas", 
  "ga jelas", "gaje", "apaan sih", "ngawur", "halu", "anjing", "kontol", "memek"
].some(k => teks.includes(k))) {

  if (["bot error", "ngaco", "ngawur", "halu"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Hehe maaf ya ${namaUser}, kalau tadi ngaco üòÖ Aku masih belajar jadi bot jago ‚öΩ`
      : "Waduh maaf ya, kalau tadi error üòÖ Aku masih terus dilatih biar makin pintar ‚öΩ";
  
  } else if (["bohong", "bohong kamu", "bohong lu", "lu salah", "salah lu"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Ehh masa sih bohong ${namaUser}? Kalau salah, kasih tahu ya biar aku bisa belajar ‚öΩ`
      : "Kalau aku salah, langsung koreksi aja ya bro üòÖ Biar makin pintar ‚öΩ";
  
  } else if (["bot goblok", "goblok kamu", "bot bodoh", "bot bego"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Aduh üò¢ jangan gitu dong ${namaUser}... Aku janji gak goblok terus deh, serius ‚öΩ`
      : "üò¢ Waduh, sakit tapi tak berdarah bro... Tapi aku akan terus belajar ‚öΩ";
   
   } else if ([
    "anjing", "kontol", "memek"
  ].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Yuk kita hindari kata kasar ya ${namaUser} üôè Biar ngobrol bolanya tetap seru dan sehat ‚öΩ`
      : "Santai bro, yuk jaga kata-kata biar ngobrol bola tetap asik ‚öΩ‚úåÔ∏è";   
      
  } else if (["bot jelek", "kamu aneh", "bot aneh"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Wkwk emang kadang aneh sih ${namaUser}, tapi aku tetap semangat bantu kamu soal bola ‚öΩ`
      : "Yahh... mungkin tampilannya belum sempurna üòÖ tapi semangat bolanya full! ‚öΩ";
  
  } else if (["gak jelas", "ga jelas", "gaje", "apaan sih"].some(k => teks.includes(k))) {
    balasan = namaUser
      ? `Maaf ya ${namaUser} kalau belum jelas üòÖ Coba tanya lagi dengan lebih spesifik ‚öΩ`
      : "Kalau belum jelas, tanya ulang ya bro! Aku siap jawab ‚öΩ";
  
  } else {
    balasan = namaUser
      ? `Maafin aku ya ${namaUser}, aku nggak sempurna... Tapi semangat bantu kamu bola tetap 100%! ‚öΩüî•`
      : "Aku bukan bot sempurna, tapi semangat bantu kamu soal bola tetap full! ‚öΩ";
  }

      } else {
        balasan = namaUser ? `Maaf ${namaUser}, saya hanya bisa jawab soal sepak bola ‚öΩ` : "Maaf, saya hanya bisa jawab soal sepak bola ‚öΩ";
      }

      tampilkanBalasan(balasan);
      input.value = '';
      input.focus();
    }

    function hapusChat() {
  document.getElementById('chatArea').innerHTML = '';
  document.getElementById('chatArea').insertAdjacentHTML('afterbegin', `
  <div id="welcomeMessage" class="absolute inset-0 flex flex-col justify-center items-center text-center text-gray-400 px-4">
    <h2 class="text-2xl font-bold mb-2">Selamat datang di Bot Prediksi Sepakbola ‚öΩ</h2>
    <p class="text-base">Tanyakan apa saja seputar pertandingan bola atau unggah foto tim favoritmu!</p>
  </div>
`);
}

    async function getPrediksiScoreDanOverUnder(pertanyaan) {
      try {
        const matchRegex = /prediksi(?: skor)?\s+([a-zA-Z\s]+)\s+vs\s+([a-zA-Z\s]+)(?:\s+pada\s+tanggal\s+(\d{1,2})\s+([a-zA-Z]+)\s+(\d{4}))?/i;
        const match = pertanyaan.match(matchRegex);
        if (!match) return "Format pertanyaan belum dipahami bro. Contoh: Prediksi skor Persib vs Arema tanggal 10 Juli 2025";

        const team1 = match[1].trim();
        const team2 = match[2].trim();
        let tanggal = "";
        if (match[3] && match[4] && match[5]) {
          const day = match[3].padStart(2, '0');
          const month = getMonthNumber(match[4]);
          tanggal = `${match[5]}-${month}-${day}`;
        }

        const apiKey = "ce13b7fee5bfbaa4476de793b906f0d2";
        const res = await fetch(`https://api-football-v1.p.rapidapi.com/v3/fixtures/headtohead?h2h=${team1}-${team2}`, {
          headers: {
            'X-RapidAPI-Key': apiKey,
            'X-RapidAPI-Host': 'api-football-v1.p.rapidapi.com'
          }
        });

        const data = await res.json();
        const matches = data.response;

        if (!matches || matches.length === 0) return "Tidak ditemukan data head-to-head untuk tim tersebut.";

        let totalGol = 0;
        let over = 0, under = 0;
        matches.forEach(m => {
          const g1 = m.goals.home ?? 0;
          const g2 = m.goals.away ?? 0;
          const total = g1 + g2;
          totalGol += total;
          total > 2.5 ? over++ : under++;
        });

        const rataGol = (totalGol / matches.length).toFixed(2);
        return `üìä Prediksi ${team1} vs ${team2}:\n- Rata-rata gol: ${rataGol}\n- Over 2.5: ${over}x\n- Under 2.5: ${under}x\nüéØ Perkiraan: ${rataGol > 2.5 ? "Over 2.5 ‚öΩ" : "Under 2.5 ‚öΩ"}`;
      } catch (err) {
        return "Gagal ambil data dari API bro. Coba lagi nanti.";
      }
    }

    function getMonthNumber(bulan) {
      const map = {
        januari: "01", februari: "02", maret: "03", april: "04", mei: "05",
        juni: "06", juli: "07", agustus: "08", september: "09",
        oktober: "10", november: "11", desember: "12"
      };
      return map[bulan.toLowerCase()] || "01";
    }

    async function getJadwalLigaHariIni(teks) {
      try {
        const apiKey = "ce13b7fee5bfbaa4476de793b906f0d2";
        const ligaMapping = {
          "liga inggris": 39, "premier league": 39,
          "liga spanyol": 140, "la liga": 140,
          "liga italia": 135, "serie a": 135,
          "liga jerman": 78, "bundesliga": 78,
          "liga prancis": 61, "ligue 1": 61
        };

        const ditemukan = Object.keys(ligaMapping).find(nama => teks.includes(nama));
        if (!ditemukan) return "Nama liga tidak dikenali bro. Contoh: Liga Inggris, La Liga, Serie A";

        const idLiga = ligaMapping[ditemukan];
        const tanggalHariIni = new Date().toISOString().split("T")[0];

        const res = await fetch(`https://api-football-v1.p.rapidapi.com/v3/fixtures?date=${tanggalHariIni}&league=${idLiga}&season=2024`, {
          headers: {
            'X-RapidAPI-Key': apiKey,
            'X-RapidAPI-Host': 'api-football-v1.p.rapidapi.com'
          }
        });

        const data = await res.json();
        const match = data.response;

        if (!match || match.length === 0) return `Tidak ada pertandingan ${ditemukan} hari ini bro.`;

        const jadwal = match.map(m => {
          const home = m.teams.home.name;
          const away = m.teams.away.name;
          const jam = new Date(m.fixture.date).toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
          return `- ${home} vs ${away} (${jam} WIB)`;
        }).join("\n");

        return `üìÖ Jadwal ${ditemukan.toUpperCase()} hari ini:\n${jadwal}`;
      } catch (err) {
        return "Ups! Gagal ambil jadwal liga. Coba lagi nanti bro.";
      }
    }

    async function getJadwalSemuaLigaHariIni() {
      try {
        const apiKey = "ce13b7fee5bfbaa4476de793b906f0d2";
        const tanggalHariIni = new Date().toISOString().split("T")[0];

        const res = await fetch(`https://api-football-v1.p.rapidapi.com/v3/fixtures?date=${tanggalHariIni}&season=2024`, {
          headers: {
            'X-RapidAPI-Key': apiKey,
            'X-RapidAPI-Host': 'api-football-v1.p.rapidapi.com'
          }
        });

        const data = await res.json();
        const match = data.response;

        if (!match || match.length === 0) return "Tidak ada pertandingan bola hari ini bro.";

        const jadwal = match.map(m => {
          const home = m.teams.home.name;
          const away = m.teams.away.name;
          const jam = new Date(m.fixture.date).toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
          return `- ${home} vs ${away} (${jam} WIB)`;
        }).join("\n");

        return `üìÖ Jadwal pertandingan bola hari ini:\n${jadwal}`;
      } catch (err) {
        return "Ups! Gagal ambil jadwal hari ini. Coba lagi nanti bro.";
      }
    }

    async function getPeluangMenang(teks) {
  try {
    const match = teks.match(/(?:peluang menang)\s+([a-zA-Z\s]+)\s+vs\s+([a-zA-Z\s]+)/i);
    if (!match || !match[1] || !match[2]) {
      return "Format tidak dikenali. Coba: Peluang menang Madrid vs Barca";
    }

    const team1 = match[1].trim();
    const team2 = match[2].trim();
    const apiKey = "ce13b7fee5bfbaa4476de793b906f0d2";

    const res = await fetch(`https://api-football-v1.p.rapidapi.com/v3/fixtures/headtohead?h2h=${team1}-${team2}`, {
      headers: {
        'X-RapidAPI-Key': apiKey,
        'X-RapidAPI-Host': 'api-football-v1.p.rapidapi.com'
      }
    });

    const data = await res.json();
    const matches = data.response;
    if (!matches || matches.length === 0) {
      return `Belum ada data head-to-head ${team1} vs ${team2}.`;
    }

    let menang1 = 0, menang2 = 0, seri = 0;
    matches.forEach(m => {
      const g1 = m.goals.home ?? 0;
      const g2 = m.goals.away ?? 0;

      if (m.teams.home.name.toLowerCase().includes(team1.toLowerCase())) {
        if (g1 > g2) menang1++;
        else if (g1 < g2) menang2++;
        else seri++;
      } else {
        if (g1 > g2) menang2++;
        else if (g1 < g2) menang1++;
        else seri++;
      }
    });

    const total = menang1 + menang2 + seri;
    const persen = x => ((x / total) * 100).toFixed(1);

    return `üìä Peluang Menang ${team1} vs ${team2} (berdasarkan ${total} pertemuan):
- ${team1}: ${persen(menang1)}%
- Seri: ${persen(seri)}%
- ${team2}: ${persen(menang2)}%`;
  } catch (err) {
    return "Gagal menghitung peluang menang. Coba lagi nanti bro.";
  }
}

 </script>
</body>
</html>

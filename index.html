<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BotPrediksi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    #chatArea {
      scroll-behavior: smooth;
    }
  </style>
</head>
<body class="bg-gray-900 text-white">

  <!-- ‚úÖ HEADER FIXED -->
  <header class="bg-gray-800 fixed top-0 left-0 w-full z-50 flex justify-between items-center px-4 py-3">
    <button class="text-white text-2xl">‚ò∞</button>
    <h1 class="text-lg font-bold">BotPrediksi</h1>
    <button class="text-white text-2xl">‚öôÔ∏è</button>
  </header>

  <!-- ‚úÖ MAIN CHAT AREA SCROLLABLE -->
  <main id="chatArea" class="pt-16 pb-24 px-4 space-y-4 overflow-y-auto max-w-4xl mx-auto h-[calc(100vh-8rem)]">
    <!-- Chat akan muncul di sini -->
  </main>

  <!-- ‚úÖ FOOTER FIXED -->
  <footer class="bg-gray-800 fixed bottom-0 left-0 w-full z-50 p-3 flex items-center space-x-2 max-w-4xl mx-auto">
    
    <!-- Tombol ‚ûï dengan Menu Pilihan -->
    <div class="relative">
      <button onclick="toggleUploadMenu()" class="text-white text-xl">‚ûï</button>
      <div id="uploadMenu" class="absolute bottom-12 left-0 bg-gray-700 text-sm rounded-xl hidden shadow-md z-50 w-48">
        <label class="flex items-center gap-2 px-4 py-2 hover:bg-gray-600 cursor-pointer">
          üì∏ Ambil foto
          <input type="file" accept="image/*" capture="environment" onchange="handleImage(this.files[0])" class="hidden">
        </label>
        <label class="flex items-center gap-2 px-4 py-2 hover:bg-gray-600 cursor-pointer">
          üñºÔ∏è Tambah foto
          <input type="file" accept="image/*" onchange="handleImage(this.files[0])" class="hidden">
        </label>
        <label class="flex items-center gap-2 px-4 py-2 hover:bg-gray-600 cursor-pointer">
          üìé Tambah file
          <input type="file" onchange="handleFile(this.files[0])" class="hidden">
        </label>
      </div>
    </div>

    <!-- Input -->
    <input id="userInput" type="text" placeholder="Tulis pertanyaan di sini..."
      class="flex-1 bg-gray-700 text-white px-4 py-2 rounded-full outline-none"
      onkeydown="if(event.key==='Enter') kirimPesan()" />

    <!-- Tombol Kirim dengan Ikon Panah -->
    <button class="text-white text-xl" onclick="kirimPesan()">‚¨ÜÔ∏è</button>
  </footer>

  <!-- ‚úÖ SCRIPT -->
  <script>
    let namaUser = "";

    function scrollToBottom() {
      const chatArea = document.getElementById('chatArea');
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    function kirimPesan() {
      const input = document.getElementById('userInput');
      const pesan = input.value.trim();
      if (pesan === '') return;

      const chatArea = document.getElementById('chatArea');

      const userBubble = document.createElement('div');
      userBubble.className = 'bg-gray-800 p-3 rounded-lg w-fit max-w-[80%] mb-2';
      userBubble.textContent = pesan;
      chatArea.appendChild(userBubble);

      const teks = pesan.toLowerCase();
      let balasan = "";

      if (teks.includes("nama saya") || teks.includes("saya") || teks.includes("aku")) {
        const namaMatch = teks.match(/(nama saya|saya|aku)\s+([a-zA-Z]+)/);
        if (namaMatch && namaMatch[2]) {
          namaUser = namaMatch[2].charAt(0).toUpperCase() + namaMatch[2].slice(1);
          balasan = `Hai ${namaUser}! Nama kamu keren ‚öΩ. Silakan tanya tentang sepak bola!`;
        } else {
          balasan = "Boleh tahu siapa nama kamu, bro?";
        }
      } else if (["halo", "hai", "assalamualaikum", "pagi", "malam", "sore"].some(k => teks.includes(k))) {
        balasan = namaUser
          ? `Halo ${namaUser}! Siap bahas bola? ‚öΩ`
          : "Halo! Selamat datang di BotPrediksi ‚öΩ. Silakan tanya tentang bola ya!";
      } else if (["siapa kamu", "nama kamu", "kamu siapa"].some(k => teks.includes(k))) {
        balasan = "Saya BotPrediksi ‚öΩ, siap bantu kamu soal bola 24 jam!";
      } else if (["terima kasih", "makasih"].some(k => teks.includes(k))) {
        balasan = namaUser
          ? `Sama-sama ${namaUser}! Jangan lupa tanya prediksi lagi ya ‚öΩ`
          : "Sama-sama bro! Kapan pun mau tanya bola, saya siap ‚öΩ";
      } else if (["apa kabar", "gimana kabar", "sehat"].some(k => teks.includes(k))) {
        balasan = namaUser
          ? `Saya baik ${namaUser}, kamu gimana? Siap nonton bola? ‚öΩ`
          : "Saya baik-baik saja bro! Siap bantu prediksi bola kapan pun!";
      } else if (["bantuan", "help", "gimana caranya", "cara pakai"].some(k => teks.includes(k))) {
        balasan = "Tulis aja pertanyaanmu tentang bola, misalnya 'Prediksi Madrid vs Barca' ‚öΩ";
      } else if (["goblok", "bego", "tolol", "anjing"].some(k => teks.includes(k))) {
        balasan = "Waduh bro, jangan emosi üòÖ kita seru-seruan aja bahas bola ‚öΩ";
      } else {
        balasan = namaUser
          ? `Maaf ${namaUser}, saya hanya bisa jawab soal sepak bola ‚öΩ`
          : "Maaf, saya hanya bisa jawab soal sepak bola ‚öΩ";
      }

      const botBubble = document.createElement('div');
      botBubble.className = 'bg-green-600 p-3 rounded-lg w-fit max-w-[80%] ml-auto';
      botBubble.textContent = balasan;
      chatArea.appendChild(botBubble);

      scrollToBottom();
      input.value = '';
    }

    function toggleUploadMenu() {
      const menu = document.getElementById("uploadMenu");
      menu.classList.toggle("hidden");
      document.addEventListener("click", function closeOutside(e) {
        if (!menu.contains(e.target)) {
          menu.classList.add("hidden");
        }
      }, { once: true });
    }

    function handleImage(file) {
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const imageUrl = e.target.result;
          const chatArea = document.getElementById('chatArea');

          const imgDiv = document.createElement("div");
          imgDiv.className = "w-fit max-w-[80%]";
          imgDiv.innerHTML = `<img src="${imageUrl}" class="rounded-xl max-w-xs mb-2" alt="gambar kiriman">`;
          chatArea.appendChild(imgDiv);

          setTimeout(() => {
            const botReply = document.createElement("div");
            botReply.className = "bg-green-600 p-3 rounded-lg w-fit max-w-[80%] ml-auto";
            botReply.textContent = "üì∑ Gambar diterima! Akan saya analisis dalam konteks sepak bola ‚öΩ";
            chatArea.appendChild(botReply);
            scrollToBottom();
          }, 700);

          scrollToBottom();
        };
        reader.readAsDataURL(file);
      }
    }

    function handleFile(file) {
      if (file) {
        const chatArea = document.getElementById("chatArea");
        const fileDiv = document.createElement("div");
        fileDiv.className = "bg-gray-800 p-3 rounded-lg w-fit max-w-[80%] mb-2 text-sm";
        fileDiv.textContent = `üìé File "${file.name}" telah diunggah. (fitur analisis file belum aktif)`;
        chatArea.appendChild(fileDiv);
        scrollToBottom();
      }
    }
  </script>

</body>
</html>
